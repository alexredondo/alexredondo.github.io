<html> 
  <head> </head> 
  <body> 
    <!-- <! -- 
    ANTES DE EJECUTAR: 
    --------------- 
    1. Si aún no lo ha hecho, habilite la API de Hojas de cálculo de Google 
       y verifique cuota para su proyecto en 
       https://console.developers.google.com/apis/api/sheets 
    2. Obtenga claves de acceso para su aplicación. Consulte 
       https://developers.google.com/api-client-library/javascript/start/start-js#get-access-keys-for-your-application 
    3. Para obtener información adicional sobre la autenticación, consulte 
       https: // desarrolladores .google.com / sheet / api / quickstart / js # step_2_set_up_the_sample 
  -->
    <script> 
    function makeApiCall () { 
      var params = {
        // The ID of the spreadsheet to retrieve data from.
        spreadsheetId: '1Y-sr-7QMaoOZZnLM_7Sxwfgl0PnkdvNgPcqepMZuK9w',  // TODO: Update placeholder value.

        // The A1 notation of the values to retrieve.
        range: 'datosEstudiantes',  // TODO: Update placeholder value.

        // How values should be represented in the output.
        // The default render option is ValueRenderOption.FORMATTED_VALUE.
        valueRenderOption: 'FORMATTED_VALUE',  // TODO: Update placeholder value.

        // How dates, times, and durations should be represented in the output.
        // This is ignored if value_render_option is
        // FORMATTED_VALUE.
        // The default dateTime render option is [DateTimeRenderOption.SERIAL_NUMBER].
        dateTimeRenderOption: 'SERIAL_NUMBER'  // TODO: Update placeholder value.
      };

      var request = gapi.client.sheets.spreadsheets.values.get(params);
      request.then(function(response) {
        // TODO: Change code below to process the `response` object:
        console.log(response.result.values);
      }, function(reason) {
        console.error('error: ' + reason.result.error.message);
      });
    }

    function initClient() {
      var API_KEY = 'AIzaSyDpAYPh03HbCnlhBGefw3DLAF10MIf0ruM';  // TODO: Update placeholder with desired API key.

      var CLIENT_ID = '18806597319-43iollcieqio34r6n6pn88f8qaguakkj.apps.googleusercontent.com';  // TODO: Update placeholder with desired client ID.

      // TODO: Authorize using one of the following scopes:
      // 'https://www.googleapis.com/auth/drive' 
      // 'https://www.googleapis.com/auth/drive.file' 
      // 'https://www.googleapis.com/auth /drive.readonly ' 
      //' https://www.googleapis.com/auth/spreadsheets ' 
      //' https://www.googleapis.com/auth/spreadsheets.readonly ' 
      var SCOPE ='https://www.googleapis.com/auth/spreadsheets.readonly'; 
      gapi.client.init ({ 
        'apiKey': API_KEY, 
        'clientId': CLIENT_ID, 
        'scope': SCOPE, 
        'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4' ] 
      }). then (function () { 
        gapi.auth2.getAuthInstance (). isSignedIn.listen (updateSignInStatus);

        updateSignInStatus (gapi.auth2.getAuthInstance (). isSignedIn.get ()); 
      }); 
    } 
    function handleClientLoad () { 
      gapi.load ('cliente: auth2', initClient); 
    } 
    function updateSignInStatus (isSignedIn) { 
      if (isSignedIn) { 
        makeApiCall (); 
      } 
    } 
    function handleSignInClick (event) { 
      gapi.auth2.getAuthInstance (). signIn (); 
    } 
    function handleSignOutClick (evento) { 
      gapi.auth2.getAuthInstance (). signOut (); 
    } 
    </script> 
    <script async defer src = "https://apis.google.com/js/api.js"
      onload = "this.onload = function () {}; handleClientLoad ()" 
      onreadystatechange = "if (this.readyState === 'complete') this.onload ()"> 
    </script> 
    <button id = "signin- button "onclick =" handleSignInClick () "> Iniciar sesión </button> 
    <button id =" signout-button "onclick =" handleSignOutClick () "> Cerrar sesión </button> 
  </body> 
</html>
